# 插件管理器文档

## 插件信息
- 名称: 插件管理器
- 版本: 1.0
- 作者: Xiaoyi

## 功能概述
插件管理器是一个功能完整的插件管理系统,提供 Web 界面和命令行接口来管理插件、查看系统信息、日志和消息历史。

## 主要功能
1. Web 管理界面
2. 插件启用/停用
3. 系统信息监控
4. 日志查看
5. 消息历史记录
6. 菜单管理
7. 安全登录验证

## Web 界面

### 访问方式
```
http://localhost:36674
```

### 默认登录凭据
- 用户名: admin
- 密码: admin

### 主要页面
- 首页: 系统信息和插件管理
- 日志页: 查看系统日志
- 历史记录: 查看消息历史
- 发送消息: 消息测试工具

## 命令行指令

### 插件管理
```
启用插件 [插件名]
停用插件 [插件名]
列出插件
插件信息 [插件名]
```

### 菜单管理
```
添加菜单 [项目名]
删除菜单 [项目名]
显示菜单
```

### WebUI 控制
```
启动插件管理器WebUI
```

## 系统监控
监控以下系统指标:
- CPU 使用率
- 内存使用情况
- 磁盘使用情况
- 系统运行时间
- 上次关机时间
- Python 版本
- 系统启动时间

## 配置文件
### 主要配置文件
```
plugin_menu.json      # 菜单配置
last_shutdown.txt     # 关机时间记录
bot.log              # 系统日志
message_history.json  # 消息历史
```

### 插件目录结构
```
plugins/
  ├── plugin1.py
  ├── plugin2.py
  └── xyi_disabled_plugin.py  # 已停用的插件
```

## 安全特性
1. 会话管理和登录验证
2. 本地主机限制 (127.0.0.1)
3. 管理员权限控制
4. 安全的命令执行

## API 参考

### 系统信息 API
```
GET /system_info
返回: JSON 格式的系统状态信息
```

### 插件管理 API
```
POST /toggle_plugin
参数:
  - plugin: 插件名
  - action: enable/disable
```

### 历史记录 API
```
GET /history
POST /delete_history
```

## 注意事项
1. 确保运行时具有足够的系统权限
2. 定期清理日志和历史记录
3. 修改默认登录凭据
4. 避免在公网环境暴露管理接口

## 依赖项
- Flask
- psutil
- platform
- threading
- subprocess
- datetime
- JSON

## 错误处理
- 插件加载失败保护
- 系统信息获取异常处理
- API 请求异常处理
- 文件操作异常处理

## 更新日志
### v1.0
- 初始版本发布
- 完整的 Web 管理界面
- 基础插件管理功能
- 系统监控功能